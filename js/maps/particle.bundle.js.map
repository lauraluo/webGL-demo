{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/particle.jsx"],"names":[],"mappings":"AAAA;;;ACCI;AACA,IAAI,QAAJ;AACA,IAAI,KAAJ;AACA,IAAI,MAAJ;AACA,IAAI,IAAJ;AACA,IAAI,OAAJ;AACA,IAAI,mBAAmB,EAAvB;AACA,IAAI,iBAAiB,EAArB;AACA,IAAI,SAAS,EAAb;AACA,IAAI,YAAY,KAAhB;AACA,IAAI,KAAJ;;AAEA,SAAS,IAAT,GAAgB;;AAEZ;AACA,YAAQ,IAAI,MAAM,KAAV,EAAR;;AAEA;AACA,aAAS,IAAI,MAAM,iBAAV,CAA4B,EAA5B,EAAgC,OAAO,UAAP,GAAoB,OAAO,WAA3D,EAAwE,GAAxE,EAA6E,KAA7E,CAAT;;AAEA;AACA,eAAW,IAAI,MAAM,aAAV,EAAX;AACA,aAAS,aAAT,CAAuB,QAAvB,EAAiC,GAAjC;AACA,aAAS,OAAT,CAAiB,OAAO,UAAxB,EAAoC,OAAO,WAA3C;;AAEA;AACA,QAAI,QAAQ,IAAI,MAAM,gBAAV,EAAZ;AACA,UAAM,QAAN,CAAe,GAAf,CAAmB,IAAnB,EAAyB,IAAzB,EAA+B,IAA/B;AACA,UAAM,GAAN,CAAU,KAAV;;AAEA;AACA;AACA,WAAO,QAAP,CAAgB,CAAhB,GAAoB,CAApB;AACA,WAAO,QAAP,CAAgB,CAAhB,GAAoB,CAApB;AACA,WAAO,QAAP,CAAgB,CAAhB,GAAoB,IAApB;AACA,WAAO,MAAP,CAAc,MAAM,QAApB;;AAEA;AACA,aAAS,IAAT,CAAc,WAAd,CAA0B,SAAS,UAAnC;;AAEA,YAAQ,IAAI,MAAM,aAAV,CAAwB,MAAxB,CAAR;AACA,cAAU,IAAI,YAAY;AACtB,aAAK,OAAL,GAAe,YAAY;AACvB,wBAAY,IAAZ;AACH,SAFD;AAGA,aAAK,OAAL,GAAe,YAAY;AACvB,wBAAY,KAAZ;AACH,SAFD;AAGA,aAAK,KAAL,GAAa,GAAb;AACH,KARS,EAAV;AASA,gBAAY,OAAZ;;AAEA;AAIH;;AAED,SAAS,qBAAT,GAAiC;AAC7B,QAAI,QAAQ,GAAZ;AACA,QAAI,QAAQ,GAAZ;;AAEA,QAAI,WAAW,CAAf;AACA,QAAI,WAAW,CAAf;AACA,QAAI,eAAe,CAAnB;;AAEA,QAAI,SAAS,SAAS,aAAT,CAAuB,QAAvB,CAAb;AACA,WAAO,KAAP,GAAe,GAAf;AACA,WAAO,MAAP,GAAgB,GAAhB;AACA,QAAI,MAAM,OAAO,UAAP,CAAkB,IAAlB,CAAV;;AAEA,QAAI,MAAM,IAAI,KAAJ,EAAV;AACA,QAAI,GAAJ,GAAU,kBAAV;AACA,QAAI,MAAJ,GAAa,YAAY;AACrB;AACA,YAAI,SAAJ,CAAc,GAAd,EAAmB,CAAnB,EAAsB,CAAtB;AACA,YAAI,QAAQ,IAAI,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,KAAvB,EAA8B,KAA9B,CAAZ;AACA;AACA;AACA,YAAI,YAAY,KAAK,QAAL,CAAc,KAAK,IAAL,CAAU,GAAV,EAAe,GAAf,CAAd,EAAmC,EAAnC,CAAhB;;AAEA,eAAO,IAAI,MAAM,QAAV,EAAP;;AAEA,YAAI,SAAS,EAAb;AACA,aAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAApB,EAA2B,GAA3B,EAAgC;;AAE5B,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAApB,EAA2B,GAA3B,EAAgC;AAC5B,0BAAU,KAAV,CAAgB,CAAhB,EAAmB,CAAnB,IAAwB,SAAS,CAC7B,MAAM,IAAN,CAAY,IAAE,CAAH,GAAQ,IAAI,KAAJ,GAAY,CAA/B,CAD6B,EAE7B,MAAM,IAAN,CAAY,IAAE,CAAH,GAAM,CAAN,GAAU,IAAI,KAAJ,GAAY,CAAjC,CAF6B,EAG7B,MAAM,IAAN,CAAY,IAAE,CAAH,GAAM,CAAN,GAAU,IAAI,KAAJ,GAAY,CAAjC,CAH6B,EAI/B,IAJ+B,CAI1B,GAJ0B,CAAT,GAIX,GAJb;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAI,SAAS,MAAM,IAAN,CAAW,IAAI,CAAJ,GAAS,QAAQ,CAAR,GAAY,CAAhC,IAAsC,YAAnD;AACA,oBAAI,SAAS,IAAI,MAAM,OAAV,CAAkB,IAAI,QAAtB,EAAgC,MAAhC,EAAyC,IAAI,QAA7C,CAAb;AACA,qBAAK,QAAL,CAAc,IAAd,CAAmB,MAAnB;AAEH;AACJ;;AAED,aAAK,OAAL,CAAa,SAAb,EAAwB,UAAS,KAAT,EAAgB;AACpC,mBAAO,IAAP,CAAY,IAAI,MAAM,KAAV,CAAgB,KAAhB,CAAZ;AACH,SAFD;AAGA,aAAK,MAAL,GAAc,MAAd;;AAGA,aAAK,WAAL,CAAiB,IAAI,MAAM,OAAV,GAAoB,aAApB,CAAkC,KAAK,EAAL,GAAU,CAA5C,CAAjB;AACA,aAAK,WAAL,CAAiB,IAAI,MAAM,OAAV,GAAoB,aAApB,CAAkC,CAAC,KAAK,EAAN,GAAW,CAA7C,CAAjB;;AAIA;AACA;AACA;AACA,aAAK,IAAI,KAAI,CAAb,EAAgB,KAAI,QAAQ,CAA5B,EAA+B,IAA/B,EAAoC;AAChC,iBAAK,IAAI,KAAI,CAAb,EAAgB,KAAI,QAAQ,CAA5B,EAA+B,IAA/B,EAAoC;AAChC;AACA;AACA;AACA;AACA,oBAAI,IAAI,KAAI,KAAI,KAAhB;AACA,oBAAI,IAAK,KAAI,CAAL,GAAW,KAAI,KAAvB;AACA,oBAAI,IAAI,KAAK,CAAC,KAAI,CAAL,IAAU,KAAvB;AACA,oBAAI,IAAK,KAAI,CAAL,GAAW,CAAC,KAAI,CAAL,IAAU,KAA7B;;AAEA,oBAAI,QAAQ,IAAI,MAAM,KAAV,CAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,CAAZ;AACA,oBAAI,QAAQ,IAAI,MAAM,KAAV,CAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,CAAZ;;AAEA,qBAAK,KAAL,CAAW,IAAX,CAAgB,KAAhB;AACA,qBAAK,KAAL,CAAW,IAAX,CAAgB,KAAhB;AACH;AACJ;;AAED,aAAK,oBAAL;AACA,aAAK,kBAAL;AACA,aAAK,kBAAL;;AAEA,yCAAiC,IAAjC;AACH,KAxED;AA0EH;;AAED,SAAS,YAAT,CAAsB,QAAtB,EAAgC,IAAhC,EAAsC;AAClC;AACA,QAAI,KAAK,SAAS,QAAT,CAAkB,KAAK,CAAvB,EAA0B,CAAnC;AACA,QAAI,KAAK,SAAS,QAAT,CAAkB,KAAK,CAAvB,EAA0B,CAAnC;AACA,QAAI,KAAK,SAAS,QAAT,CAAkB,KAAK,CAAvB,EAA0B,CAAnC;AACA;AACA,WAAO,KAAK,GAAL,CAAS,EAAT,EAAa,EAAb,EAAiB,EAAjB,CAAP;AACH;;AAED,SAAS,gCAAT,CAA0C,IAA1C,EAAgD;;AAG5C,SAAK,QAAL,CAAc,OAAd,CAAsB,UAAU,CAAV,EAAa;AAC/B,UAAE,QAAF,GAAa,KAAK,MAAL,EAAb;AACH,KAFD;;AAKA,QAAI,SAAS,IAAI,MAAM,aAAV,EAAb;;AAGA,QAAI,QAAQ,IAAI,MAAM,cAAV,EAAZ;AACA,UAAM,YAAN,GAAqB,MAAM,YAA3B;AACA;AACA;AACA;;AAEA,QAAI,KAAK,IAAI,MAAM,MAAV,CAAiB,IAAjB,EAAuB,KAAvB,CAAT;AACA,OAAG,aAAH,GAAmB,IAAnB;AACA;;AAEA,OAAG,UAAH,CAAc,GAAd;AACA,OAAG,UAAH,CAAc,GAAd;AACA,UAAM,GAAN,CAAU,EAAV;;AAEA,SAAK,IAAI,KAAI,CAAb,EAAgB,KAAI,KAAK,QAAL,CAAc,MAAlC,EAA0C,IAA1C,EAA+C;AAC3C,yBAAiB,IAAjB,CAAsB,IAAI,MAAM,OAAV,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,CAAtB;AACA,uBAAe,IAAf,CAAoB,CAApB;AACH;;AAED;AACA;AACA,SAAK,KAAL,CAAW,OAAX,CAAmB,UAAU,CAAV,EAAa;;AAE5B;AACA,YAAI,KAAK,EAAE,aAAF,CAAgB,CAAhB,CAAT;AACA,YAAI,KAAK,EAAE,aAAF,CAAgB,CAAhB,CAAT;AACA,YAAI,KAAK,EAAE,aAAF,CAAgB,CAAhB,CAAT;;AAEA;AACA;AACA;AACA;AACA,uBAAe,EAAE,CAAjB,KAAuB,CAAvB;AACA,uBAAe,EAAE,CAAjB,KAAuB,CAAvB;AACA,uBAAe,EAAE,CAAjB,KAAuB,CAAvB;;AAEA;AACA,yBAAiB,EAAE,CAAnB,EAAsB,GAAtB,CAA0B,EAA1B;AACA,yBAAiB,EAAE,CAAnB,EAAsB,GAAtB,CAA0B,EAA1B;AACA,yBAAiB,EAAE,CAAnB,EAAsB,GAAtB,CAA0B,EAA1B;AAEH,KApBD;;AAsBA;AACA;AACA,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,iBAAiB,MAArC,EAA6C,GAA7C,EAAkD;AAC9C,yBAAiB,CAAjB,EAAoB,YAApB,CAAiC,eAAe,CAAf,CAAjC;AACH;;AAED;AACA;AAEH;;AAED,SAAS,OAAT,CAAiB,QAAjB,EAA2B;;AAGvB,QAAI,MAAM,aAAa,IAAb,GAAoB,CAAC,CAArB,GAAyB,CAAnC;;AAEA,QAAI,QAAQ,CAAZ;AACA,SAAK,QAAL,CAAc,OAAd,CAAsB,UAAU,CAAV,EAAa;AAC/B,UAAE,CAAF,IAAQ,iBAAiB,KAAjB,EAAwB,CAAxB,GAA4B,EAAE,QAA9B,GAAyC,QAAQ,KAAlD,GAA2D,GAAlE;AACA,UAAE,CAAF,IAAQ,iBAAiB,KAAjB,EAAwB,CAAxB,GAA4B,EAAE,QAA9B,GAAyC,QAAQ,KAAlD,GAA2D,GAAlE;AACA,UAAE,CAAF,IAAQ,iBAAiB,KAAjB,EAAwB,CAAxB,GAA4B,EAAE,QAA9B,GAAyC,QAAQ,KAAlD,GAA2D,GAAlE;;AAGA;AACH,KAPD;AAQA,SAAK,kBAAL,GAA0B,IAA1B;AACH;;AAGD,SAAS,WAAT,CAAqB,aAArB,EAAoC;AAChC,QAAI,MAAM,IAAI,IAAI,GAAR,EAAV;AACA,QAAI,GAAJ,CAAQ,aAAR,EAAuB,SAAvB;AACA,QAAI,GAAJ,CAAQ,aAAR,EAAuB,SAAvB;AACA,QAAI,GAAJ,CAAQ,aAAR,EAAuB,OAAvB,EAAgC,CAAhC,EAAmC,CAAnC,EAAsC,IAAtC,CAA2C,IAA3C;AACH;;AAED,SAAS,MAAT,GAAkB;AACd,aAAS,MAAT,CAAgB,KAAhB,EAAuB,MAAvB;;AAEA,UAAM,MAAN;;AAEA,QAAI,SAAJ,EAAe;AACX,gBAAQ,IAAR;AACH,KAFD,MAEO;AACH,gBAAQ,KAAR;AACH;;AAED,0BAAsB,MAAtB;AACH;;AAED;AACA,OAAO,MAAP,GAAgB,IAAhB","file":"../../webgl/particle.bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\n    // global variables\n    var renderer;\n    var scene;\n    var camera;\n    var geom;\n    var control;\n    var avgVertexNormals = [];\n    var avgVertexCount = [];\n    var colors = [];\n    var doExplode = false;\n    var orbit;\n\n    function init() {\n\n        // create a scene, that will hold all our elements such as objects, cameras and lights.\n        scene = new THREE.Scene();\n\n        // create a camera, which defines where we're looking at.\n        camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 10000);\n\n        // create a render, sets the background color and the size\n        renderer = new THREE.WebGLRenderer();\n        renderer.setClearColor(0x000000, 1.0);\n        renderer.setSize(window.innerWidth, window.innerHeight);\n\n        // add light\n        var light = new THREE.DirectionalLight();\n        light.position.set(1200, 1200, 1200);\n        scene.add(light);\n\n        // position and point the camera to the center of the scene\n        // 不知為何光不見了就看不到\n        camera.position.x = 0;\n        camera.position.y = 0;\n        camera.position.z = 1000;\n        camera.lookAt(scene.position);\n\n        // add the output of the renderer to the html element\n        document.body.appendChild(renderer.domElement);\n\n        orbit = new THREE.OrbitControls(camera);\n        control = new function () {\n            this.explode = function () {\n                doExplode = true;\n            }\n            this.implode = function () {\n                doExplode = false;\n            }\n            this.scale = 0.1;\n        };\n        addControls(control);\n\n        createGeometryFromMap();\n\n\n        \n    }\n\n    function createGeometryFromMap() {\n        var depth = 512;\n        var width = 512;\n\n        var spacingX = 1;\n        var spacingZ = 1;\n        var heightOffset = 2;\n\n        var canvas = document.createElement('canvas');\n        canvas.width = 512;\n        canvas.height = 512;\n        var ctx = canvas.getContext('2d');\n\n        var img = new Image();\n        img.src = \"images/demo2.png\";\n        img.onload = function () {\n            // draw on canvas\n            ctx.drawImage(img, 0, 0);\n            var pixel = ctx.getImageData(0, 0, width, depth);\n            // console.log(pixel.data.length );//1048576\n            //data長度為 128 取RGBA陣列中的A data長度為 512*512*4 其中的4代表每px的rgba\n            var matColors = math.multiply(math.ones(512, 512), '');\n\n            geom = new THREE.Geometry;\n\n            var output = [];\n            for (let x = 0; x < depth; x++) {\n\n                for (let z = 0; z < width; z++) {\n                    matColors._data[z][x] = 'rgb('+ ([\n                        pixel.data[(x*4) + z * depth * 4],\n                        pixel.data[(x*4)+1 + z * depth * 4],\n                        pixel.data[(x*4)+2 + z * depth * 4]\n                    ].join(','))+')';\n\n\n                    // colors.push(new THREE.Color('rgba(255,255,255)'));\n                    // get pixel\n                    // since we're grayscale, we only need one element\n                    //每張圖取出來的px資料，是代表rgba的256色陣列\n                    //*4，跳四格取第4個a的透明度作為高度(y軸)參考\n                    //* spacing 放大比例尺也許是比較好看？\n                    var yValue = pixel.data[z * 4 + (depth * x * 4)] / heightOffset;\n                    var vertex = new THREE.Vector3(x * spacingX, yValue , z * spacingZ);\n                    geom.vertices.push(vertex);\n\n                }\n            }\n\n            math.forEach(matColors, function(value) {\n                colors.push(new THREE.Color(value));\n            });\n            geom.colors = colors;\n\n\n            geom.applyMatrix(new THREE.Matrix4().makeRotationX(Math.PI / 2));\n            geom.applyMatrix(new THREE.Matrix4().makeRotationZ(-Math.PI / 2));\n\n\n\n            //制作面\n            // we create a rectangle between four vertices, and we do\n            // that as two triangles.\n            for (let z = 0; z < depth - 1; z++) {\n                for (let x = 0; x < width - 1; x++) {\n                    // we need to point to the position in the array\n                    // a - - b\n                    // |  x  |\n                    // c - - d\n                    var a = x + z * width;\n                    var b = (x + 1) + (z * width);\n                    var c = x + ((z + 1) * width);\n                    var d = (x + 1) + ((z + 1) * width);\n\n                    var face1 = new THREE.Face3(a, b, d);\n                    var face2 = new THREE.Face3(d, c, a);\n\n                    geom.faces.push(face1);\n                    geom.faces.push(face2);\n                }\n            }\n\n            geom.computeVertexNormals();\n            geom.computeFaceNormals();\n            geom.computeBoundingBox();\n\n            createParticleSystemFromGeometry(geom);\n        };\n\n    }\n\n    function getHighPoint(geometry, face) {\n        //face中有原生的3個abc屬性\n        var v1 = geometry.vertices[face.a].y;\n        var v2 = geometry.vertices[face.b].y;\n        var v3 = geometry.vertices[face.c].y;\n        // console.log(face.a);\n        return Math.max(v1, v2, v3);\n    }\n\n    function createParticleSystemFromGeometry(geom) {\n\n\n        geom.vertices.forEach(function (v) {\n            v.velocity = Math.random();\n        });\n\n        \n        var loader = new THREE.TextureLoader();\n        \n\n        var psMat = new THREE.PointsMaterial();\n        psMat.vertexColors = THREE.VertexColors;\n        // psMat.blending = THREE.AdditiveBlending;\n        // psMat.transparent = true;\n        // psMat.alphaTest = 0.8;\n\n        var ps = new THREE.Points(geom, psMat);\n        ps.sortParticles = true;\n        // ps.rotation.x = Math.PI / 2;\n\n        ps.translateX(206);\n        ps.translateY(206);\n        scene.add(ps);\n\n        for (let i = 0; i < geom.vertices.length; i++) {\n            avgVertexNormals.push(new THREE.Vector3(0, 0, 0));\n            avgVertexCount.push(0);\n        }\n\n        // first add all the normals \n        // 可以把每個 F 想成組合成3d物件的許多三角型\n        geom.faces.forEach(function (f) {\n            \n            //取得三個頂點的法向量\n            var vA = f.vertexNormals[0];\n            var vB = f.vertexNormals[1];\n            var vC = f.vertexNormals[2];\n\n            // update the count\n            // 將index計數 例如 avgVertexCount[128] +=1  先把所有出現過的座標計數\n            // 要注意f.a f.b f.c 是 index \n            // 其目的是用來減少頂點的座標存取的資訊，所以會有重複的座標\n            avgVertexCount[f.a] += 1; \n            avgVertexCount[f.b] += 1;\n            avgVertexCount[f.c] += 1;\n\n            // 將對應index的方向量值給加進去 作向量的加總\n            avgVertexNormals[f.a].add(vA);\n            avgVertexNormals[f.b].add(vB);\n            avgVertexNormals[f.c].add(vC);\n\n        });\n\n        // 算出每個向量的平均值\n        // then calculate the average\n        for (var i = 0; i < avgVertexNormals.length; i++) {\n            avgVertexNormals[i].divideScalar(avgVertexCount[i]);\n        }\n\n        // call the render function\n        render();\n\n    }\n\n    function explode(outwards) {\n\n\n        var dir = outwards === true ? -1 : 1;\n\n        var count = 0;\n        geom.vertices.forEach(function (v) {\n            v.x += (avgVertexNormals[count].x * v.velocity * control.scale) * dir;\n            v.y += (avgVertexNormals[count].y * v.velocity * control.scale) * dir;\n            v.z += (avgVertexNormals[count].z * v.velocity * control.scale) * dir;\n\n\n            count++;\n        });\n        geom.verticesNeedUpdate = true;\n    }\n\n\n    function addControls(controlObject) {\n        var gui = new dat.GUI();\n        gui.add(controlObject, 'explode');\n        gui.add(controlObject, 'implode');\n        gui.add(controlObject, 'scale', 0, 2).step(0.01);\n    }\n\n    function render() {\n        renderer.render(scene, camera);\n        \n        orbit.update();\n        \n        if (doExplode) {\n            explode(true);\n        } else {\n            explode(false);\n        }\n\n        requestAnimationFrame(render);\n    }\n\n    // calls the init function when the window is done loading.\n    window.onload = init;"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvcGFydGljbGUuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNDSTtBQUNBLElBQUksUUFBSjtBQUNBLElBQUksS0FBSjtBQUNBLElBQUksTUFBSjtBQUNBLElBQUksSUFBSjtBQUNBLElBQUksT0FBSjtBQUNBLElBQUksbUJBQW1CLEVBQXZCO0FBQ0EsSUFBSSxpQkFBaUIsRUFBckI7QUFDQSxJQUFJLFNBQVMsRUFBYjtBQUNBLElBQUksWUFBWSxLQUFoQjtBQUNBLElBQUksS0FBSjs7QUFFQSxTQUFTLElBQVQsR0FBZ0I7O0FBRVo7QUFDQSxZQUFRLElBQUksTUFBTSxLQUFWLEVBQVI7O0FBRUE7QUFDQSxhQUFTLElBQUksTUFBTSxpQkFBVixDQUE0QixFQUE1QixFQUFnQyxPQUFPLFVBQVAsR0FBb0IsT0FBTyxXQUEzRCxFQUF3RSxHQUF4RSxFQUE2RSxLQUE3RSxDQUFUOztBQUVBO0FBQ0EsZUFBVyxJQUFJLE1BQU0sYUFBVixFQUFYO0FBQ0EsYUFBUyxhQUFULENBQXVCLFFBQXZCLEVBQWlDLEdBQWpDO0FBQ0EsYUFBUyxPQUFULENBQWlCLE9BQU8sVUFBeEIsRUFBb0MsT0FBTyxXQUEzQzs7QUFFQTtBQUNBLFFBQUksUUFBUSxJQUFJLE1BQU0sZ0JBQVYsRUFBWjtBQUNBLFVBQU0sUUFBTixDQUFlLEdBQWYsQ0FBbUIsSUFBbkIsRUFBeUIsSUFBekIsRUFBK0IsSUFBL0I7QUFDQSxVQUFNLEdBQU4sQ0FBVSxLQUFWOztBQUVBO0FBQ0E7QUFDQSxXQUFPLFFBQVAsQ0FBZ0IsQ0FBaEIsR0FBb0IsQ0FBcEI7QUFDQSxXQUFPLFFBQVAsQ0FBZ0IsQ0FBaEIsR0FBb0IsQ0FBcEI7QUFDQSxXQUFPLFFBQVAsQ0FBZ0IsQ0FBaEIsR0FBb0IsSUFBcEI7QUFDQSxXQUFPLE1BQVAsQ0FBYyxNQUFNLFFBQXBCOztBQUVBO0FBQ0EsYUFBUyxJQUFULENBQWMsV0FB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OztBQUdELFNBQVMsV0FBVCxDQUFxQixhQUFyQixFQUFvQztBQUNoQyxRQUFJLE1BQU0sSUFBSSxJQUFJLEdBQVIsRUFBVjtBQUNBLFFBQUksR0FBSixDQUFRLGFBQVIsRUFBdUIsU0FBdkI7QUFDQSxRQUFJLEdBQUosQ0FBUSxhQUFSLEVBQXVCLFNBQXZCO0FBQ0EsUUFBSSxHQUFKLENBQVEsYUFBUixFQUF1QixPQUF2QixFQUFnQyxDQUFoQyxFQUFtQyxDQUFuQyxFQUFzQyxJQUF0QyxDQUEyQyxJQUEzQztBQUNIOztBQUVELFNBQVMsTUFBVCxHQUFrQjtBQUNkLGFBQVMsTUFBVCxDQUFnQixLQUFoQixFQUF1QixNQUF2Qjs7QUFFQSxVQUFNLE1BQU47O0FBRUEsUUFBSSxTQUFKLEVBQWU7QUFDWCxnQkFBUSxJQUFSO0FBQ0gsS0FGRCxNQUVPO0FBQ0gsZ0JBQVEsS0FBUjtBQUNIOztBQUVELDBCQUFzQixNQUF0QjtBQUNIOztBQUVEO0FBQ0EsT0FBTyxNQUFQLEdBQWdCLElBQWhCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlxuICAgIC8vIGdsb2JhbCB2YXJpYWJsZXNcbiAgICB2YXIgcmVuZGVyZXI7XG4gICAgdmFyIHNjZW5lO1xuICAgIHZhciBjYW1lcmE7XG4gICAgdmFyIGdlb207XG4gICAgdmFyIGNvbnRyb2w7XG4gICAgdmFyIGF2Z1ZlcnRleE5vcm1hbHMgPSBbXTtcbiAgICB2YXIgYXZnVmVydGV4Q291bnQgPSBbXTtcbiAgICB2YXIgY29sb3JzID0gW107XG4gICAgdmFyIGRvRXhwbG9kZSA9IGZhbHNlO1xuICAgIHZhciBvcmJpdDtcblxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG5cbiAgICAgICAgLy8gY3JlYXRlIGEgc2NlbmUsIHRoYXQgd2lsbCBob2xkIGFsbCBvdXIgZWxlbWVudHMgc3VjaCBhcyBvYmplY3RzLCBjYW1lcmFzIGFuZCBsaWdodHMuXG4gICAgICAgIHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cbiAgICAgICAgLy8gY3JlYXRlIGEgY2FtZXJhLCB3aGljaCBkZWZpbmVzIHdoZXJlIHdlJ3JlIGxvb2tpbmcgYXQuXG4gICAgICAgIGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg0NSwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDAuMSwgMTAwMDApO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBhIHJlbmRlciwgc2V0cyB0aGUgYmFja2dyb3VuZCBjb2xvciBhbmQgdGhlIHNpemVcbiAgICAgICAgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcigpO1xuICAgICAgICByZW5kZXJlci5zZXRDbGVhckNvbG9yKDB4MDAwMDAwLCAxLjApO1xuICAgICAgICByZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuXG4gICAgICAgIC8vIGFkZCBsaWdodFxuICAgICAgICB2YXIgbGlnaHQgPSBuZXcgVEhSRUUuRGlyZWN0aW9uYWxMaWdodCgpO1xuICAgICAgICBsaWdodC5wb3NpdGlvbi5zZXQoMTIwMCwgMTIwMCwgMTIwMCk7XG4gICAgICAgIHNjZW5lLmFkZChsaWdodCk7XG5cbiAgICAgICAgLy8gcG9zaXRpb24gYW5kIHBvaW50IHRoZSBjYW1lcmEgdG8gdGhlIGNlbnRlciBvZiB0aGUgc2NlbmVcbiAgICAgICAgLy8g5LiN55+l54K65L2V5YWJ5LiN6KaL5LqG5bCx55yL5LiN5YiwXG4gICAgICAgIGNhbWVyYS5wb3NpdGlvbi54ID0gMDtcbiAgICAgICAgY2FtZXJhLnBvc2l0aW9uLnkgPSAwO1xuICAgICAgICBjYW1lcmEucG9zaXRpb24ueiA9IDEwMDA7XG4gICAgICAgIGNhbWVyYS5sb29rQXQoc2NlbmUucG9zaXRpb24pO1xuXG4gICAgICAgIC8vIGFkZCB0aGUgb3V0cHV0IG9mIHRoZSByZW5kZXJlciB0byB0aGUgaHRtbCBlbGVtZW50XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocmVuZGVyZXIuZG9tRWxlbWVudCk7XG5cbiAgICAgICAgb3JiaXQgPSBuZXcgVEhSRUUuT3JiaXRDb250cm9scyhjYW1lcmEpO1xuICAgICAgICBjb250cm9sID0gbmV3IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZXhwbG9kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBkb0V4cGxvZGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbXBsb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGRvRXhwbG9kZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zY2FsZSA9IDAuMTtcbiAgICAgICAgfTtcbiAgICAgICAgYWRkQ29udHJvbHMoY29udHJvbCk7XG5cbiAgICAgICAgY3JlYXRlR2VvbWV0cnlGcm9tTWFwKCk7XG5cblxuICAgICAgICBcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVHZW9tZXRyeUZyb21NYXAoKSB7XG4gICAgICAgIHZhciBkZXB0aCA9IDUxMjtcbiAgICAgICAgdmFyIHdpZHRoID0gNTEyO1xuXG4gICAgICAgIHZhciBzcGFjaW5nWCA9IDE7XG4gICAgICAgIHZhciBzcGFjaW5nWiA9IDE7XG4gICAgICAgIHZhciBoZWlnaHRPZmZzZXQgPSAyO1xuXG4gICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgY2FudmFzLndpZHRoID0gNTEyO1xuICAgICAgICBjYW52YXMuaGVpZ2h0ID0gNTEyO1xuICAgICAgICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgICBpbWcuc3JjID0gXCJpbWFnZXMvZGVtbzIucG5nXCI7XG4gICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBkcmF3IG9uIGNhbnZhc1xuICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIDApO1xuICAgICAgICAgICAgdmFyIHBpeGVsID0gY3R4LmdldEltYWdlRGF0YSgwLCAwLCB3aWR0aCwgZGVwdGgpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocGl4ZWwuZGF0YS5sZW5ndGggKTsvLzEwNDg1NzZcbiAgICAgICAgICAgIC8vZGF0YemVt+W6pueCuiAxMjgg5Y+WUkdCQemZo+WIl+S4reeahEEgZGF0YemVt+W6pueCuiA1MTIqNTEyKjQg5YW25Lit55qENOS7o+ihqOavj3B455qEcmdiYVxuICAgICAgICAgICAgdmFyIG1hdENvbG9ycyA9IG1hdGgubXVsdGlwbHkobWF0aC5vbmVzKDUxMiwgNTEyKSwgJycpO1xuXG4gICAgICAgICAgICBnZW9tID0gbmV3IFRIUkVFLkdlb21ldHJ5O1xuXG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IGRlcHRoOyB4KyspIHtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IHogPSAwOyB6IDwgd2lkdGg7IHorKykge1xuICAgICAgICAgICAgICAgICAgICBtYXRDb2xvcnMuX2RhdGFbel1beF0gPSAncmdiKCcrIChbXG4gICAgICAgICAgICAgICAgICAgICAgICBwaXhlbC5kYXRhWyh4KjQpICsgeiAqIGRlcHRoICogNF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBwaXhlbC5kYXRhWyh4KjQpKzEgKyB6ICogZGVwdGggKiA0XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsLmRhdGFbKHgqNCkrMiArIHogKiBkZXB0aCAqIDRdXG4gICAgICAgICAgICAgICAgICAgIF0uam9pbignLCcpKSsnKSc7XG5cblxuICAgICAgICAgICAgICAgICAgICAvLyBjb2xvcnMucHVzaChuZXcgVEhSRUUuQ29sb3IoJ3JnYmEoMjU1LDI1NSwyNTUpJykpO1xuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgcGl4ZWxcbiAgICAgICAgICAgICAgICAgICAgLy8gc2luY2Ugd2UncmUgZ3JheXNjYWxlLCB3ZSBvbmx5IG5lZWQgb25lIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgLy/mr4/lvLXlnJblj5blh7rkvobnmoRweOizh+aWme+8jOaYr+S7o+ihqHJnYmHnmoQyNTboibLpmaPliJdcbiAgICAgICAgICAgICAgICAgICAgLy8qNO+8jOi3s+Wbm+agvOWPluesrDTlgIth55qE6YCP5piO5bqm5L2c54K66auY5bqmKHnou7gp5Y+D6ICDXG4gICAgICAgICAgICAgICAgICAgIC8vKiBzcGFjaW5nIOaUvuWkp+avlOS+i+WwuuS5n+ioseaYr+avlOi8g+Wlveeci++8n1xuICAgICAgICAgICAgICAgICAgICB2YXIgeVZhbHVlID0gcGl4ZWwuZGF0YVt6ICogNCArIChkZXB0aCAqIHggKiA0KV0gLyBoZWlnaHRPZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ZXJ0ZXggPSBuZXcgVEhSRUUuVmVjdG9yMyh4ICogc3BhY2luZ1gsIHlWYWx1ZSAsIHogKiBzcGFjaW5nWik7XG4gICAgICAgICAgICAgICAgICAgIGdlb20udmVydGljZXMucHVzaCh2ZXJ0ZXgpO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtYXRoLmZvckVhY2gobWF0Q29sb3JzLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGNvbG9ycy5wdXNoKG5ldyBUSFJFRS5Db2xvcih2YWx1ZSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBnZW9tLmNvbG9ycyA9IGNvbG9ycztcblxuXG4gICAgICAgICAgICBnZW9tLmFwcGx5TWF0cml4KG5ldyBUSFJFRS5NYXRyaXg0KCkubWFrZVJvdGF0aW9uWChNYXRoLlBJIC8gMikpO1xuICAgICAgICAgICAgZ2VvbS5hcHBseU1hdHJpeChuZXcgVEhSRUUuTWF0cml4NCgpLm1ha2VSb3RhdGlvblooLU1hdGguUEkgLyAyKSk7XG5cblxuXG4gICAgICAgICAgICAvL+WItuS9nOmdolxuICAgICAgICAgICAgLy8gd2UgY3JlYXRlIGEgcmVjdGFuZ2xlIGJldHdlZW4gZm91ciB2ZXJ0aWNlcywgYW5kIHdlIGRvXG4gICAgICAgICAgICAvLyB0aGF0IGFzIHR3byB0cmlhbmdsZXMuXG4gICAgICAgICAgICBmb3IgKGxldCB6ID0gMDsgeiA8IGRlcHRoIC0gMTsgeisrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB3aWR0aCAtIDE7IHgrKykge1xuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIHBvaW50IHRvIHRoZSBwb3NpdGlvbiBpbiB0aGUgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgLy8gYSAtIC0gYlxuICAgICAgICAgICAgICAgICAgICAvLyB8ICB4ICB8XG4gICAgICAgICAgICAgICAgICAgIC8vIGMgLSAtIGRcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB4ICsgeiAqIHdpZHRoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9ICh4ICsgMSkgKyAoeiAqIHdpZHRoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSB4ICsgKCh6ICsgMSkgKiB3aWR0aCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gKHggKyAxKSArICgoeiArIDEpICogd2lkdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBmYWNlMSA9IG5ldyBUSFJFRS5GYWNlMyhhLCBiLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZhY2UyID0gbmV3IFRIUkVFLkZhY2UzKGQsIGMsIGEpO1xuXG4gICAgICAgICAgICAgICAgICAgIGdlb20uZmFjZXMucHVzaChmYWNlMSk7XG4gICAgICAgICAgICAgICAgICAgIGdlb20uZmFjZXMucHVzaChmYWNlMik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnZW9tLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7XG4gICAgICAgICAgICBnZW9tLmNvbXB1dGVGYWNlTm9ybWFscygpO1xuICAgICAgICAgICAgZ2VvbS5jb21wdXRlQm91bmRpbmdCb3goKTtcblxuICAgICAgICAgICAgY3JlYXRlUGFydGljbGVTeXN0ZW1Gcm9tR2VvbWV0cnkoZ2VvbSk7XG4gICAgICAgIH07XG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRIaWdoUG9pbnQoZ2VvbWV0cnksIGZhY2UpIHtcbiAgICAgICAgLy9mYWNl5Lit5pyJ5Y6f55Sf55qEM+WAi2FiY+WxrOaAp1xuICAgICAgICB2YXIgdjEgPSBnZW9tZXRyeS52ZXJ0aWNlc1tmYWNlLmFdLnk7XG4gICAgICAgIHZhciB2MiA9IGdlb21ldHJ5LnZlcnRpY2VzW2ZhY2UuYl0ueTtcbiAgICAgICAgdmFyIHYzID0gZ2VvbWV0cnkudmVydGljZXNbZmFjZS5jXS55O1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhmYWNlLmEpO1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgodjEsIHYyLCB2Myk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlUGFydGljbGVTeXN0ZW1Gcm9tR2VvbWV0cnkoZ2VvbSkge1xuXG5cbiAgICAgICAgZ2VvbS52ZXJ0aWNlcy5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICB2LnZlbG9jaXR5ID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgXG4gICAgICAgIHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpO1xuICAgICAgICBcblxuICAgICAgICB2YXIgcHNNYXQgPSBuZXcgVEhSRUUuUG9pbnRzTWF0ZXJpYWwoKTtcbiAgICAgICAgcHNNYXQudmVydGV4Q29sb3JzID0gVEhSRUUuVmVydGV4Q29sb3JzO1xuICAgICAgICAvLyBwc01hdC5ibGVuZGluZyA9IFRIUkVFLkFkZGl0aXZlQmxlbmRpbmc7XG4gICAgICAgIC8vIHBzTWF0LnRyYW5zcGFyZW50ID0gdHJ1ZTtcbiAgICAgICAgLy8gcHNNYXQuYWxwaGFUZXN0ID0gMC44O1xuXG4gICAgICAgIHZhciBwcyA9IG5ldyBUSFJFRS5Qb2ludHMoZ2VvbSwgcHNNYXQpO1xuICAgICAgICBwcy5zb3J0UGFydGljbGVzID0gdHJ1ZTtcbiAgICAgICAgLy8gcHMucm90YXRpb24ueCA9IE1hdGguUEkgLyAyO1xuXG4gICAgICAgIHBzLnRyYW5zbGF0ZVgoMjA2KTtcbiAgICAgICAgcHMudHJhbnNsYXRlWSgyMDYpO1xuICAgICAgICBzY2VuZS5hZGQocHMpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2VvbS52ZXJ0aWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXZnVmVydGV4Tm9ybWFscy5wdXNoKG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAsIDApKTtcbiAgICAgICAgICAgIGF2Z1ZlcnRleENvdW50LnB1c2goMCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmaXJzdCBhZGQgYWxsIHRoZSBub3JtYWxzIFxuICAgICAgICAvLyDlj6/ku6Xmiormr4/lgIsgRiDmg7PmiJDntYTlkIjmiJAzZOeJqeS7tueahOioseWkmuS4ieinkuWei1xuICAgICAgICBnZW9tLmZhY2VzLmZvckVhY2goZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy/lj5blvpfkuInlgIvpoILpu57nmoTms5XlkJHph49cbiAgICAgICAgICAgIHZhciB2QSA9IGYudmVydGV4Tm9ybWFsc1swXTtcbiAgICAgICAgICAgIHZhciB2QiA9IGYudmVydGV4Tm9ybWFsc1sxXTtcbiAgICAgICAgICAgIHZhciB2QyA9IGYudmVydGV4Tm9ybWFsc1syXTtcblxuICAgICAgICAgICAgLy8gdXBkYXRlIHRoZSBjb3VudFxuICAgICAgICAgICAgLy8g5bCHaW5kZXjoqIjmlbgg5L6L5aaCIGF2Z1ZlcnRleENvdW50WzEyOF0gKz0xICDlhYjmiormiYDmnInlh7rnj77pgY7nmoTluqfmqJnoqIjmlbhcbiAgICAgICAgICAgIC8vIOimgeazqOaEj2YuYSBmLmIgZi5jIOaYryBpbmRleCBcbiAgICAgICAgICAgIC8vIOWFtuebrueahOaYr+eUqOS+hua4m+Wwkemggum7nueahOW6p+aomeWtmOWPlueahOizh+ioiu+8jOaJgOS7peacg+aciemHjeikh+eahOW6p+aomVxuICAgICAgICAgICAgYXZnVmVydGV4Q291bnRbZi5hXSArPSAxOyBcbiAgICAgICAgICAgIGF2Z1ZlcnRleENvdW50W2YuYl0gKz0gMTtcbiAgICAgICAgICAgIGF2Z1ZlcnRleENvdW50W2YuY10gKz0gMTtcblxuICAgICAgICAgICAgLy8g5bCH5bCN5oeJaW5kZXjnmoTmlrnlkJHph4/lgLzntabliqDpgLLljrsg5L2c5ZCR6YeP55qE5Yqg57i9XG4gICAgICAgICAgICBhdmdWZXJ0ZXhOb3JtYWxzW2YuYV0uYWRkKHZBKTtcbiAgICAgICAgICAgIGF2Z1ZlcnRleE5vcm1hbHNbZi5iXS5hZGQodkIpO1xuICAgICAgICAgICAgYXZnVmVydGV4Tm9ybWFsc1tmLmNdLmFkZCh2Qyk7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8g566X5Ye65q+P5YCL5ZCR6YeP55qE5bmz5Z2H5YC8XG4gICAgICAgIC8vIHRoZW4gY2FsY3VsYXRlIHRoZSBhdmVyYWdlXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXZnVmVydGV4Tm9ybWFscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXZnVmVydGV4Tm9ybWFsc1tpXS5kaXZpZGVTY2FsYXIoYXZnVmVydGV4Q291bnRbaV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2FsbCB0aGUgcmVuZGVyIGZ1bmN0aW9uXG4gICAgICAgIHJlbmRlcigpO1xuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXhwbG9kZShvdXR3YXJkcykge1xuXG5cbiAgICAgICAgdmFyIGRpciA9IG91dHdhcmRzID09PSB0cnVlID8gLTEgOiAxO1xuXG4gICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgIGdlb20udmVydGljZXMuZm9yRWFjaChmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgdi54ICs9IChhdmdWZXJ0ZXhOb3JtYWxzW2NvdW50XS54ICogdi52ZWxvY2l0eSAqIGNvbnRyb2wuc2NhbGUpICogZGlyO1xuICAgICAgICAgICAgdi55ICs9IChhdmdWZXJ0ZXhOb3JtYWxzW2NvdW50XS55ICogdi52ZWxvY2l0eSAqIGNvbnRyb2wuc2NhbGUpICogZGlyO1xuICAgICAgICAgICAgdi56ICs9IChhdmdWZXJ0ZXhOb3JtYWxzW2NvdW50XS56ICogdi52ZWxvY2l0eSAqIGNvbnRyb2wuc2NhbGUpICogZGlyO1xuXG5cbiAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgIH0pO1xuICAgICAgICBnZW9tLnZlcnRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBhZGRDb250cm9scyhjb250cm9sT2JqZWN0KSB7XG4gICAgICAgIHZhciBndWkgPSBuZXcgZGF0LkdVSSgpO1xuICAgICAgICBndWkuYWRkKGNvbnRyb2xPYmplY3QsICdleHBsb2RlJyk7XG4gICAgICAgIGd1aS5hZGQoY29udHJvbE9iamVjdCwgJ2ltcGxvZGUnKTtcbiAgICAgICAgZ3VpLmFkZChjb250cm9sT2JqZWN0LCAnc2NhbGUnLCAwLCAyKS5zdGVwKDAuMDEpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpO1xuICAgICAgICBcbiAgICAgICAgb3JiaXQudXBkYXRlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZG9FeHBsb2RlKSB7XG4gICAgICAgICAgICBleHBsb2RlKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhwbG9kZShmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVuZGVyKTtcbiAgICB9XG5cbiAgICAvLyBjYWxscyB0aGUgaW5pdCBmdW5jdGlvbiB3aGVuIHRoZSB3aW5kb3cgaXMgZG9uZSBsb2FkaW5nLlxuICAgIHdpbmRvdy5vbmxvYWQgPSBpbml0OyJdfQ=="}